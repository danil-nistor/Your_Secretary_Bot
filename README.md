# üìÖ Telegram Bot: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –≤ Google Calendar

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç Telegram-–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä: ¬´–ó–∞–≤—Ç—Ä–∞ –≤ 15:00 –≤—Å—Ç—Ä–µ—á–∞ —Å –∫–æ–º–∞–Ω–¥–æ–π¬ª), –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏–∑ –Ω–µ–≥–æ –¥–∞–Ω–Ω—ã–µ —Å –ø–æ–º–æ—â—å—é Yandex GPT –∏ —Å–æ–∑–¥–∞—ë—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –≤ Google Calendar.

## üß© –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞—Ç—ã, –≤—Ä–µ–º–µ–Ω–∏, –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –æ–ø–∏—Å–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏—è —Å –ø–æ–º–æ—â—å—é Yandex GPT.
- –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è –≤ Google Calendar.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ OAuth2 –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–≥–æ—Ç–æ–≤ –∫ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—é).
- –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ –≤—ã–∫–ª–∞–¥—ã–≤–∞–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
project_root/
‚îú‚îÄ‚îÄ bot.py                  # –û—Å–Ω–æ–≤–Ω–æ–π Telegram-–±–æ—Ç
‚îú‚îÄ‚îÄ calendar_service.py     # –†–∞–±–æ—Ç–∞ —Å Google Calendar API
‚îú‚îÄ‚îÄ gpt.py                  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex GPT
‚îú‚îÄ‚îÄ config.py               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
‚îú‚îÄ‚îÄ credentials.json        # –ö–ª—é—á–∏ Google Cloud Console
‚îú‚îÄ‚îÄ .env                    # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ tokens/                 # –°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

---

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω Telegram –±–æ—Ç–∞

- –ù–∞–ø–∏—à–∏ [@BotFather](https://t.me/BotFather) –≤ Telegram.
- –°–æ–∑–¥–∞–π –Ω–æ–≤–æ–≥–æ –±–æ—Ç–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–∏ —Ç–æ–∫–µ–Ω.

### 2. –ù–∞—Å—Ç—Ä–æ–π Google Calendar API

1. –ü–µ—Ä–µ–π–¥–∏ –≤ [Google Cloud Console](https://console.cloud.google.com/).
2. –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π.
3. –í–∫–ª—é—á–∏ **Google Calendar API**.
4. –°–æ–∑–¥–∞–π **OAuth Client ID** —Ç–∏–ø–∞ "Other".
5. –°–∫–∞—á–∞–π `credentials.json` –∏ –ø–æ–ª–æ–∂–∏ –µ–≥–æ –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞.

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 4. –ù–∞—Å—Ç—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.env`:

```env
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here
```

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω–æ:

#### –í–∞—Ä–∏–∞–Ω—Ç 1: Webhook + ngrok (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö)

1. –ó–∞–ø—É—Å—Ç–∏ Flask-—Å–µ—Ä–≤–µ—Ä:
   ```bash
   python bot.py
   ```

2. –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏ ngrok:
   ```bash
   ngrok http 8000
   ```

3. –£—Å—Ç–∞–Ω–æ–≤–∏ webhook:
   ```bash
   curl -F "url=https://abcd1234.ngrok.io/webhook" https://api.telegram.org/bot<your_token>/setWebhook
   ```

#### –í–∞—Ä–∏–∞–Ω—Ç 2: Polling (–ø—Ä–æ—Å—Ç–æ –∏ –±—ã—Å—Ç—Ä–æ)

```bash
python bot.py
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å Google Calendar

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç:

```bash
python test_calendar.py
```

–û–Ω:
- –ü—Ä–æ–≤–µ–¥—ë—Ç OAuth –æ–¥–∏–Ω —Ä–∞–∑.
- –°–æ–∑–¥–∞—Å—Ç —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ä–∞–±–æ—Ç—É –º–æ–¥—É–ª—è `calendar_service.py`.

---

## üë• –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

- –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ö–æ–¥–∏—Ç OAuth —á–µ—Ä–µ–∑ Telegram.
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `tokens/user_{id}.pickle`.
- –í—Å–µ –¥–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –∫–∞–ª–µ–Ω–¥–∞—Ä—ë–º –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –ø–æ–¥ —ç—Ç–∏–º –∞–∫–∫–∞—É–Ω—Ç–æ–º.

> ‚úÖ MVP –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º—É–ª—å—Ç–∏–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Ä–µ–∂–∏–º, –Ω–æ –ª–µ–≥–∫–æ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

---

## üì¶ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `calendar_service.py`

```python
from calendar_service import get_calendar_service, create_calendar_event

user_id = 123456789  # Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

# –ü–æ–ª—É—á–∞–µ–º –¥–æ—Å—Ç—É–ø –∫ –∫–∞–ª–µ–Ω–¥–∞—Ä—é
service = get_calendar_service(user_id)

# –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø –µ—Å—Ç—å ‚Äî —Å–æ–∑–¥–∞—ë–º —Å–æ–±—ã—Ç–∏–µ
if service:
    event_data = {
        "–Ω–∞–∑–≤–∞–Ω–∏–µ": "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã",
        "–¥–∞—Ç–∞": "05.04.2025",
        "–≤—Ä–µ–º—è": "15:00",
        "–æ–ø–∏—Å–∞–Ω–∏–µ": "–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞",
        "–º–µ—Å—Ç–æ": "–û—Ñ–∏—Å"
    }
    result = create_calendar_event(user_id, event_data)
    print("–°–æ–±—ã—Ç–∏–µ —Å–æ–∑–¥–∞–Ω–æ:", result.get('htmlLink'))
else:
    print("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω.")
```

---

## ü§ù –î–ª—è –∫–æ–º–∞–Ω–¥—ã: –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `calendar_service.py`

–¢–≤–æ–π –∫–æ–ª–ª–µ–≥–∞ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `calendar_service.py` —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
2. –ü–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –≤ —Ñ—É–Ω–∫—Ü–∏—é `extract_event_info()` (–≤ `gpt.py`) –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è `event_data`.
3. –í—ã–∑–≤–∞—Ç—å `create_calendar_event(user_id, event_data)`.

–ü—Ä–∏–º–µ—Ä:

```python
from gpt import extract_event_info
from calendar_service import create_calendar_event

def handle_message(update, context):
    user_id = update.message.from_user.id
    message_text = update.message.text

    event_data = extract_event_info(message_text)
    result = create_calendar_event(user_id, event_data)

    if "error" in result:
        update.message.reply_text(f"–û—à–∏–±–∫–∞: {result['error']}")
    else:
        update.message.reply_text("–°–æ–±—ã—Ç–∏–µ —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ!")
```

---

## üìå –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Telegram Bot API](https://core.telegram.org/bots/api)
- [Google Calendar API Docs](https://developers.google.com/calendar)
- [Yandex GPT](https://cloud.yandex.ru/services/yandex_gpt)
- [ngrok ‚Äî –ø—Ä–æ–±—Ä–æ—Å –ø–æ—Ä—Ç–æ–≤](https://ngrok.com/)

---

## üõ†Ô∏è Roadmap / –ß—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–∞–ª—å—à–µ

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–æ–±—ã—Ç–∏–π.
- –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –≤—ã—Ä–∞–∂–µ–Ω–∏–π (¬´—á–µ—Ä–µ–∑ 2 –¥–Ω—è¬ª, ¬´–∑–∞–≤—Ç—Ä–∞¬ª, ¬´–≤ –ø—è—Ç–Ω–∏—Ü—É¬ª).
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∏–∞–ª–æ–≥ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
- –•—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–±—ã—Ç–∏–π.
- Docker-–æ–±—Ä–∞–∑ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è.

---

## ‚ù§Ô∏è –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ –∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ!  
–ï—Å–ª–∏ —Ç–µ–±–µ –ø–æ–º–æ–≥ —ç—Ç–æ—Ç —à–∞–±–ª–æ–Ω ‚Äî –∑–≤—ë–∑–¥–æ—á–∫–∞ –Ω–∞ GitHub –±—É–¥–µ—Ç –æ—Ç–ª–∏—á–Ω—ã–º –ø–æ–¥–∞—Ä–∫–æ–º üåü

--- 

–•–æ—á–µ—à—å, —è –ø–æ–¥–≥–æ—Ç–æ–≤–ª—é —ç—Ç–æ—Ç README –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–∞, —á—Ç–æ–±—ã —Ç—ã –º–æ–≥ —Å—Ä–∞–∑—É –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–≥–æ –≤ —Å–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π?
